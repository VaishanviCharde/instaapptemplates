on:
  push:
    paths:
      - .github/workflows/main.yml
name: ðŸš€ Deploy website on push
jobs:
  web-deploy:
    name: ðŸŽ‰ Deploy
    runs-on: ubuntu-latest

    env:
      apk_name: store203
      company_Name: Veggies
      restaurant_id: 963
      email: vaishnavi.charde@tissatech.com
      
    steps:
    - name: ðŸšš Get latest code
      uses: actions/checkout@v4
    
    - name: ðŸ“‚ Sync files
      uses: SamKirkland/FTP-Deploy-Action@v4.3.5
      with:
        server: 148.72.26.110
        username: ${{ secrets.ftp_username }}
        password: ${{ secrets.ftp_password }}
        server-dir: '/store203/'

    - name: Call API
      run: |
        export BASE_URL="https://restaurant60-be-dev-xtpocjmkpa-uw.a.run.app/app-url-update"
        export type="WEB"
        export restaurant_id="${{ env.restaurant_id }}"
        export apk_name2="${{ env.apk_name }}"
        export company_name="${{ env.company_Name }}"
        export email="${{ env.email }}"
        export url="http://${{ env.apk_name }}.tissatech.in"
        # export API_URL="$BASE_URL/?url=$url&type=$type&restaurant_id=$restaurant_id&app_name=$apk_name2&emails=$email&compony_name=$company_name"
        export API_URL="$BASE_URL/?url=$url&type=$type&restaurant_id=$restaurant_id&apk_name=$apk_name2&emails=$email&company_name=$company_name"
        echo "Uploading APK: $url"
        response=$(curl -X GET $API_URL)
        echo "API  Response: $response"
       
